(function(){if(!!BX.BXGUE){return}BX.BXGUE={menuPopup:null,waitPopup:null,waitTimeout:null,waitTime:500};BX.BXGUE.toggleCheckbox=function(e,s,t){e=e||window.event;if(t=="undefined"||!t){return false}var r=t.substr(0,1);var o=parseInt(t.substr(1));switch(r){case"M":if(BX.util.in_array(o,actionUsers["Moderators"]))actionUsers["Moderators"].splice(BX.util.array_search(o,actionUsers["Moderators"]),1);else actionUsers["Moderators"][actionUsers["Moderators"].length]=o;break;case"U":if(BX.util.in_array(o,actionUsers["Users"]))actionUsers["Users"].splice(BX.util.array_search(o,actionUsers["Users"]),1);else actionUsers["Users"][actionUsers["Users"].length]=o;break;case"A":if(BX.util.in_array(o,actionUsers["UsersAuto"]))actionUsers["UsersAuto"].splice(BX.util.array_search(o,actionUsers["UsersAuto"]),1);else actionUsers["UsersAuto"][actionUsers["UsersAuto"].length]=o;break;case"B":if(BX.message("GUEUseBan")=="Y"){if(BX.util.in_array(o,actionUsers["Banned"]))actionUsers["Banned"].splice(BX.util.array_search(o,actionUsers["Banned"]),1);else actionUsers["Banned"][actionUsers["Banned"].length]=o}break;case"D":if(BX.util.in_array(o,actionUsers["Departments"])){actionUsers["Departments"].splice(BX.util.array_search(o,actionUsers["Departments"]),1)}else{actionUsers["Departments"][actionUsers["Departments"].length]=o}break;default:return false}var n=BX.findChild(s,{tagName:"input"},true,false);if(e.target==n||e.srcElement==n){BX.toggleClass(s.parentNode,"sonet-members-member-block-active");return false}else{BX.toggleClass(s.parentNode,"sonet-members-member-block-active");n.checked=n.checked!=true}BX.PreventDefault(e)};BX.BXGUE.showMenu=function(e,s,t){if(!s){s="users"}var r=[];if(s=="users"){if(BX.message("GUEUserCanInitiate")){r[r.length]={text:BX.message("GUEAddToUsersTitle"),className:"menu-popup-no-icon",onclick:function(e){if(BX.SGCP){BX.SGCP.ShowForm("invite",t,e)}return BX.PreventDefault(e)}}}if(BX.message("GUEUserCanModifyGroup")){r[r.length]={text:BX.message("GUEAddToModeratorsTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.sendAjax({popup:this.menuPopup.popupWindow,action:"U2M",items:BX.util.array_merge(actionUsers["Users"],actionUsers["UsersAuto"])});return BX.PreventDefault(e)},this)};r[r.length]={text:BX.message("GUEExcludeFromGroupTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){if(confirm(BX.message("GUEExcludeFromGroupConfirmTitle"))){this.sendAjax({popup:this.menuPopup.popupWindow,action:"EX",items:BX.util.array_merge(actionUsers["Moderators"],actionUsers["Users"])})}return BX.PreventDefault(e)},this)};r[r.length]={text:BX.message("GUESetGroupOwnerTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.setGroupOwner(this.menuPopup.popupWindow);return BX.PreventDefault(e)},this)}}}else if(s=="users_auto"){if(BX.message("GUEUserCanInitiate")){r[r.length]={text:BX.message("GUEAddToUsersTitle"),className:"menu-popup-no-icon",onclick:function(e){if(BX.SGCP){BX.SGCP.ShowForm("invite",t,e)}return BX.PreventDefault(e)}}}if(BX.message("GUEUserCanModifyGroup")){r[r.length]={text:BX.message("GUEAddToModeratorsTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.sendAjax({popup:this.menuPopup.popupWindow,action:"U2M",items:BX.util.array_merge(actionUsers["Users"],actionUsers["UsersAuto"])});return BX.PreventDefault(e)},this)};r[r.length]={text:BX.message("GUESetGroupOwnerTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.setGroupOwner(this.menuPopup.popupWindow);return BX.PreventDefault(e)},this)}}}else if(s=="moderators"){if(BX.message("GUEUserCanModifyGroup")){r[r.length]={text:BX.message("GUEExcludeFromModeratorsTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.sendAjax({popup:this.menuPopup.popupWindow,action:"M2U",items:actionUsers["Moderators"]});return BX.PreventDefault(e)},this)};r[r.length]={text:BX.message("GUEExcludeFromGroupTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.sendAjax({popup:this.menuPopup.popupWindow,action:"EX",items:BX.util.array_merge(actionUsers["Moderators"],actionUsers["Users"])});return BX.PreventDefault(e)},this)};r[r.length]={text:BX.message("GUESetGroupOwnerTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.setGroupOwner(this.menuPopup.popupWindow);return BX.PreventDefault(e)},this)}}}else if(s=="ban"){if(BX.message("GUEUserCanModerateGroup")){r[r.length]={text:BX.message("GUEUnBanFromGroupTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.sendAjax({popup:this.menuPopup.popupWindow,action:"UNBAN",items:actionUsers["Banned"]});return BX.PreventDefault(e)},this)}}}else if(s=="departments"){if(BX.message("GUEUserCanModifyGroup")){r[r.length]={text:BX.message("GUESetGroupUnconnectDeptTitle"),className:"menu-popup-no-icon",onclick:BX.proxy(function(e){this.sendAjax({popup:this.menuPopup.popupWindow,action:"UNCONNECT_DEPT",items:actionUsers["Departments"]});return BX.PreventDefault(e)},this)}}}if(r.length>0){var o={offsetLeft:-32,offsetTop:4,lightShadow:false,angle:{position:"top",offset:60}};this.menuPopup=BX.PopupMenu.create("gue-menu-"+s,e,r,o);this.menuPopup.popupWindow.show()}};BX.BXGUE.sendAjax=function(e){if(e.items.length>0){this.showWait();var s={ACTION:e.action,GROUP_ID:parseInt(BX.message("GUEGroupId")),sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))};if(e.action=="UNCONNECT_DEPT"){s.DEPARTMENT_ID=e.items}else{s.USER_ID=e.items}BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:s,onsuccess:BX.proxy(function(s){this.processAJAXResponse(s,e.popup)},this)})}else{this.showError(BX.message(e.action=="UNCONNECT_DEPT"?"GUEErrorDepartmentIDNotDefined":"GUEErrorUserIDNotDefined"))}};BX.BXGUE.setGroupOwner=function(e){if(actionUsers["Moderators"].length===1||actionUsers["Users"].length===1||actionUsers["UsersAuto"].length===1){var s=parseInt(actionUsers["Moderators"].length===1?actionUsers["Moderators"][0]:actionUsers["Users"].length===1?actionUsers["Users"][0]:actionUsers["UsersAuto"][0]);if(typeof oldOwnerID!="undefined"&&s==parseInt(oldOwnerID)){this.showError(BX.message("GUEErrorSameOwner"))}else if(confirm(BX.message("GUESetGroupOwnerConfirmTitle"))){this.showWait();BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:{ACTION:"SETOWNER",GROUP_ID:parseInt(BX.message("GUEGroupId")),USER_ID:[s],sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))},onsuccess:BX.proxy(function(s){this.processAJAXResponse(s,e)},this)})}}else{this.showError(BX.message("GUEErrorUserIDIncorrect"))}};BX.BXGUE.processAJAXResponse=function(e,s){if(s=="undefined"||s==null||!s.isShown())return false;if(e["SUCCESS"]!="undefined"&&e["SUCCESS"]=="Y"){s.close();BX.reload()}else if(e["ERROR"]!="undefined"&&e["ERROR"].length>0){if(e["ERROR"].indexOf("USER_ACTION_FAILED",0)===0){this.showError(BX.message("GUEErrorActionFailedPattern").replace("#ERROR#",e["ERROR"].substr(20)));return false}else if(e["ERROR"].indexOf("SESSION_ERROR",0)===0){this.showError(BX.message("GUEErrorSessionWrong"));BX.reload()}else if(e["ERROR"].indexOf("USER_GROUP_NO_PERMS",0)===0){this.showError(BX.message("GUEErrorNoPerms"));return false}else if(e["ERROR"].indexOf("USER_ID_NOT_DEFINED",0)===0){this.showError(BX.message("GUEErrorUserIDNotDefined"));return false}else if(e["ERROR"].indexOf("DEPARTMENT_ID_NOT_DEFINED",0)===0){this.showError(BX.message("GUEErrorDepartmentIDNotDefined"));return false}else if(e["ERROR"].indexOf("GROUP_ID_NOT_DEFINED",0)===0){this.showError(BX.message("GUEErrorGroupIDNotDefined"));return false}else if(e["ERROR"].indexOf("CURRENT_USER_NOT_AUTH",0)===0){this.showError(BX.message("GUEErrorCurrentUserNotAuthorized"));return false}else if(e["ERROR"].indexOf("SONET_MODULE_NOT_INSTALLED",0)===0){this.showError(BX.message("GUEErrorModuleNotInstalled"));return false}else if(e["ERROR"].indexOf("SONET_GUE_T_OWNER_CANT_EXCLUDE_HIMSELF",0)===0){this.showError(BX.message("GUEErrorOwnerCantExcludeHimself"));return false}else if(e["ERROR"].indexOf("SONET_GUE_T_CANT_EXCLUDE_AUTO_MEMBER",0)===0){this.showError(BX.message("GUEErrorCantExcludeAutoMember"));return false}else if(e["ERROR"].indexOf("DEPARTMENT_ACTION_FAILED",0)===0){this.showError(BX.message("GUEErrorActionFailedPattern").replace("#ERROR#",e["ERROR"].substr(26)));return false}else{this.showError(e["ERROR"]);return false}}};BX.BXGUE.showError=function(e){this.closeWait();var s=new BX.PopupWindow("gue-error"+Math.random(),window,{autoHide:true,lightShadow:false,zIndex:2,content:BX.create("DIV",{props:{className:"sonet-members-error-text-block"},html:e}),closeByEsc:true,closeIcon:true});s.show()};BX.BXGUE.showWait=function(e){if(e!==0){return this.waitTimeout=setTimeout(BX.proxy(function(){this.showWait(0)},this),50)}if(!this.waitPopup){this.waitPopup=new BX.PopupWindow("gue_wait",window,{autoHide:true,lightShadow:true,zIndex:2,content:BX.create("DIV",{props:{className:"sonet-members-wait-cont"},children:[BX.create("DIV",{props:{className:"sonet-members-wait-icon"}}),BX.create("DIV",{props:{className:"sonet-members-wait-text"},html:BX.message("GUEWaitTitle")})]})})}else{this.waitPopup.setBindElement(window)}this.waitPopup.show()};BX.BXGUE.closeWait=function(){if(this.waitTimeout){clearTimeout(this.waitTimeout);this.waitTimeout=null}if(this.waitPopup){this.waitPopup.close()}}})();
//# sourceMappingURL=script.map.js