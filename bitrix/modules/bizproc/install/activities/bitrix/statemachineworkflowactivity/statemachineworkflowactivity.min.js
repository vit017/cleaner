StateMachineWorkflowActivity=function(){var e=new BizProcActivity;e.classname="StateMachineWorkflowActivity";e.Table=null;e.__l=[];e.SerializeStateMachineWorkflowActivity=e.Serialize;e.Serialize=function(){if(e.childActivities.length>0)e.Properties["InitialStateName"]=e.childActivities[0]["Name"];return e.SerializeStateMachineWorkflowActivity()};e.LineMouseOver=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#ee0000";l.style.zIndex=parseInt(l.style.zIndex)+1e3}};e.LineMouseOut=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#afb8d2";l.style.zIndex=parseInt(l.style.zIndex)-1e3}};e.DrawLines=function(){var t,i;for(t=0;t<e.__l.length;t++)for(i=0;i<e.__l[t].length;i++)e.__l[t][i].parentNode.removeChild(e.__l[t][i]);e.__l=[];e.StatusArrows=[];e.FindSetState(false,e);var l=[],o=e.StatusArrows,s,r={};for(t=0;t<o.length;t++){s=o[t][0]+"|"+o[t][1];if(!(s in r)){r[s]=true;l.push(o[t])}}for(t=0;t<l.length;t++){var a=ActGetRealPos(document.getElementById(l[t][0]));var n=ActGetRealPos(document.getElementById(l[t][1]));if(a===false||n===false||a["left"]<=0||n["left"]<=0)continue;var p=e.Table.parentNode;var c=p.appendChild(document.createElement("IMG"));c.style.position="absolute";c.style.zIndex=14+t*10;c.width="8";c.height="8";var h=p.appendChild(document.createElement("IMG"));h.style.position="absolute";h.style.zIndex=15+t*10;h.width="8";h.height="8";var d=p.appendChild(document.createElement("DIV"));d.style.position="absolute";d.style.backgroundColor="#afb8d2";d.style.zIndex=11+t*10;d.style.height="2px";d.id=l[t][0]+"-"+l[t][1]+".1";d.onmouseover=e.LineMouseOver;d.onmouseout=e.LineMouseOut;var f=p.appendChild(document.createElement("DIV"));f.style.position="absolute";f.style.backgroundColor="#afb8d2";f.style.zIndex=12+t*10;f.style.width="2px";f.id=l[t][0]+"-"+l[t][1]+".2";f.onmouseover=e.LineMouseOver;f.onmouseout=e.LineMouseOut;var u=p.appendChild(document.createElement("DIV"));u.style.position="absolute";u.style.backgroundColor="#afb8d2";u.style.zIndex=13+t*10;u.style.height="2px";u.id=l[t][0]+"-"+l[t][1]+".3";u.onmouseover=e.LineMouseOver;u.onmouseout=e.LineMouseOut;var y=u.appendChild(document.createElement("IMG"));y.width="1";y.height="1";y=d.appendChild(document.createElement("IMG"));y.width="1";y.height="1";a["right"]=a["right"]+10;a["left"]=a["left"]-10;var g,v=t*6-50,m=12;if(a["right"]<n["left"]){g=n["left"]-a["right"];d.style.left=a["right"]+"px";d.style.width=g/2+v+"px";f.style.left=a["right"]+g/2+v+"px";u.style.left=a["right"]+g/2+v+"px";c.src="/bitrix/images/bizproc/arr_l1.gif";c.style.left=a["right"]-2+"px";c.style.top=a["top"]+m-3+"px";h.src="/bitrix/images/bizproc/arr_r1.gif";h.style.left=n["left"]+"px";h.style.top=n["top"]+m-3+"px"}else if(a["left"]==n["left"]){g=150;d.style.left=a["left"]-g/2+v+"px";d.style.width=g/2-v+"px";f.style.left=a["left"]-g/2+v+"px";u.style.left=a["left"]-g/2+v+"px";c.src="/bitrix/images/bizproc/arr_l2.gif";c.style.left=a["left"]-6+"px";c.style.top=a["top"]+m-3+"px";h.src="/bitrix/images/bizproc/arr_r1.gif";h.style.left=n["left"]+"px";h.style.top=n["top"]+m-3+"px"}else{g=a["left"]-n["right"];d.style.left=n["right"]+g/2-v+"px";d.style.width=g/2+v+"px";f.style.left=n["right"]+g/2-v+"px";u.style.left=n["right"]+"px";c.src="/bitrix/images/bizproc/arr_r2.gif";c.style.left=a["left"]-6+"px";c.style.top=a["top"]+m-3+"px";h.src="/bitrix/images/bizproc/arr_l2.gif";h.style.left=n["right"]-8+"px";h.style.top=n["top"]+m-3+"px"}d.style.top=a["top"]+m+"px";if(a["top"]<n["top"]){f.style.top=a["top"]+m+"px";f.style.height=n["top"]-a["top"]+"px"}else{f.style.top=n["top"]+m+"px";f.style.height=a["top"]-n["top"]+"px"}u.style.top=n["top"]+Math.floor((n["bottom"]-n["top"])/2)+"px";u.style.width=g/2-v+2+"px";e.__l.push([c,d,f,u,h])}};e.FindSetState=function(t,i){if(i.Type=="SetStateActivity"){if(i.Properties["TargetStateName"])e.StatusArrows.push([t,i.Properties["TargetStateName"]])}else{for(var l=0;l<i.childActivities.length;l++){if(i.Type=="StateActivity")t=i.childActivities[l].Name;e.FindSetState(t,i.childActivities[l])}}};e.Draw=function(t){e.statediv=t;e.Table=t.appendChild(_crt(e.childActivities.length+1,3));e.Table.onresize=function(){};var i;for(i=0;i<e.childActivities.length;i++){e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[2].align="left";e.childActivities[i].Draw(e.Table.rows[i].cells[i%2*2])}i=e.childActivities.length;e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[0].width="350px";e.Table.rows[i].cells[1].width="150px";e.Table.rows[i].cells[2].align="left";var l=jsUtils.CreateElement("INPUT",{type:"button",value:BPMESS["STM_ADD_STATUS"]});l.style.marginBottom="20px";e.Table.rows[i].cells[i%2*2].appendChild(l);e.Table.rows[i].cells[(i+1)%2*2].innerHTML="&nbsp";l.onclick=e.AddStatus;e.ReCheckPosition(true)};e.AddStatus=function(t){var i=e.childActivities.length;var l=CreateActivity("StateActivity");e.childActivities.push(l);l.parentActivity=e;l.Draw(e.Table.rows[i].cells[i%2*2]);var o=e.Table.insertRow(-1);o.insertCell(-1).align="right";o.insertCell(-1).align="center";o.insertCell(-1).align="left";i++;e.Table.rows[i].cells[i%2*2].appendChild(this);l.Settings()};e.RemoveChildStateMachine=e.RemoveChild;e.RemoveChild=function(t){e.RemoveChildStateMachine(t);e.Table.parentNode.removeChild(e.Table);e.Draw(e.statediv)};e.RemoveResourcesActivity=e.RemoveResources;e.RemoveResources=function(){e.RemoveResourcesActivity();if(e.Table){e.Table.parentNode.removeChild(e.Table);e.Table=null}};e.ReCheckPosition=function(t){if(e.Table.style.display=="none")return;var i=ActGetRealPos(e.Table);if(t||e.__lpos!=i["left"]||e.__rpos!=i["right"]){e.__lpos=i["left"];e.__rpos=i["right"];e.DrawLines()}setTimeout(function(){e.ReCheckPosition.call(e)},1e3)};return e};
//# sourceMappingURL=statemachineworkflowactivity.map.js